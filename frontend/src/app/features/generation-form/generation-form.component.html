  <div class="max-w-2xl mx-auto">
    <h1 class="text-2xl font-bold mb-6">Create New Collection</h1>
    <form [formGroup]="generationForm" (ngSubmit)="onSubmit()" class="space-y-6">

      <div>
        <label for="name" class="block text-sm font-medium text-gray-700">Collection Name</label>
        <input id="name" type="text" formControlName="name" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
        @if (generationForm.get('name')?.invalid && generationForm.get('name')?.touched) {
          <p class="mt-1 text-sm text-red-600">Collection name is required.</p>
        }
      </div>

      <div>
        <app-language-selector formControlName="languages"></app-language-selector>
        @if (generationForm.get('languages')?.hasError('required') && generationForm.get('languages')?.touched) {
          <p class="mt-1 text-sm text-red-600">Please select both languages.</p>
        }
        @if (generationForm.get('languages')?.hasError('languageMatch') && generationForm.get('languages')?.touched) {
          <p class="mt-1 text-sm text-red-600">Base and target languages cannot be the same.</p>
        }
      </div>

      <div>
        <label for="cardsToGenerate" class="block text-sm font-medium text-gray-700">Number of Cards to Generate</label>
        <input id="cardsToGenerate" type="number" formControlName="cardsToGenerate" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
        @if (generationForm.get('cardsToGenerate')?.invalid && generationForm.get('cardsToGenerate')?.touched) {
          <p class="mt-1 text-sm text-red-600">Please enter a number between 1 and 100.</p>
        }
      </div>

      <div>
        <app-source-input formControlName="source"></app-source-input>
        @if (generationForm.get('source')?.invalid && generationForm.get('source')?.touched) {
          <p class="mt-1 text-sm text-red-600">A text or PDF source is required.</p>
        }
      </div>

      <div>
        <button type="submit" [disabled]="generationForm.invalid || isLoading()" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50">
          @if (isLoading()) {
            <span class="animate-pulse">Generating...</span>
          } @else {
            <span>Generate</span>
          }
        </button>
      </div>
    </form>
  </div>

@if (isLoading()) {
  <div class="fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50">
    <div class="animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-white"></div>
  </div>
}